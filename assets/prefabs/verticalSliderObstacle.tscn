[gd_scene load_steps=5 format=3 uid="uid://b4td75yw32yb4"]

[ext_resource type="Texture2D" uid="uid://lv2ld1b86bnv" path="res://assets/images/icon.svg" id="1_n6l5q"]

[sub_resource type="RectangleShape2D" id="RectangleShape2D_bl13t"]
size = Vector2(15, 14)

[sub_resource type="GDScript" id="GDScript_iyx0m"]
resource_name = "obstacleButtonCollider"
script/source = "extends CollisionShape2D

@onready var start_position: Vector2 = self.position
@onready var slider_length: float = get_child(0).shape.extents.y
@onready var grabber_length: float = self.shape.extents.y

@export var is_filled: bool = false

func calculate_grabber_y_offset(slider_value):
	return - (slider_length - grabber_length) * slider_value * 2

func calculate_grabber_position(slider_value):
	return Vector2(start_position.x, 
			calculate_grabber_y_offset(slider_value) + start_position.y)

func _on_slider_value_changed(value):
	if is_filled:
		var new_rectangle = RectangleShape2D.new()
		new_rectangle.size = Vector2(self.shape.extents.x, 
				calculate_grabber_y_offset(value) + grabber_length)
		self.set_shape(new_rectangle)
		self.position = Vector2(start_position.x, start_position.y + new_rectangle.size.y / 2)
	else:
		self.position = calculate_grabber_position(value)
"

[sub_resource type="RectangleShape2D" id="RectangleShape2D_1bw8s"]
size = Vector2(14.5, 163)

[node name="AnimatableBody2D" type="AnimatableBody2D"]

[node name="Control2" type="Control" parent="."]
layout_mode = 3
anchors_preset = 0
offset_left = -63.0
offset_top = -8.0
offset_right = -63.0
offset_bottom = -8.0

[node name="VSlider" type="VSlider" parent="Control2"]
layout_mode = 0
offset_left = 55.0
offset_top = -74.0
offset_right = 71.0
offset_bottom = 90.0
max_value = 1.0
step = 0.01

[node name="SliderCollider2" type="CollisionShape2D" parent="."]
position = Vector2(0, 74)
shape = SubResource("RectangleShape2D_bl13t")
script = SubResource("GDScript_iyx0m")

[node name="SliderLength" type="CollisionShape2D" parent="SliderCollider2"]
position = Vector2(-0.25, -74.5)
shape = SubResource("RectangleShape2D_1bw8s")
disabled = true

[node name="Sprite2D" type="Sprite2D" parent="SliderCollider2"]
scale = Vector2(0.117187, 0.109375)
texture = ExtResource("1_n6l5q")

[connection signal="value_changed" from="Control2/VSlider" to="SliderCollider2" method="_on_slider_value_changed"]
